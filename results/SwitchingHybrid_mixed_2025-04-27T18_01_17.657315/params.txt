popularity: <=3
weighted:   <5
CF:         else
